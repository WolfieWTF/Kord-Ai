const _0x34e314=_0x4fce;function _0x4fce(_0x4dd952,_0x7e205b){const _0xebc2eb=_0xebc2();return _0x4fce=function(_0x4fce99,_0x58475b){_0x4fce99=_0x4fce99-0x1b6;let _0x267831=_0xebc2eb[_0x4fce99];return _0x267831;},_0x4fce(_0x4dd952,_0x7e205b);}(function(_0x353a5c,_0x3ea2bf){const _0x73c9af=_0x4fce,_0x5d37c5=_0x353a5c();while(!![]){try{const _0x22b602=parseInt(_0x73c9af(0x205))/0x1+parseInt(_0x73c9af(0x1c4))/0x2+parseInt(_0x73c9af(0x1be))/0x3*(-parseInt(_0x73c9af(0x1fe))/0x4)+-parseInt(_0x73c9af(0x224))/0x5+-parseInt(_0x73c9af(0x20e))/0x6+-parseInt(_0x73c9af(0x1d2))/0x7+parseInt(_0x73c9af(0x1e1))/0x8;if(_0x22b602===_0x3ea2bf)break;else _0x5d37c5['push'](_0x5d37c5['shift']());}catch(_0x36e17f){_0x5d37c5['push'](_0x5d37c5['shift']());}}}(_0xebc2,0x92cd1));const fs=require('fs')['promises'],fss=require('fs'),path=require(_0x34e314(0x1f3)),{default:makeWASocket,useMultiFileAuthState,DisconnectReason,fetchLatestBaileysVersion,makeCacheableSignalKeyStore,makeInMemoryStore}=require('@whiskeysockets/baileys'),{Boom}=require(_0x34e314(0x1c8)),pino=require('pino'),NodeCache=require(_0x34e314(0x217)),chalk=require('chalk'),axios=require(_0x34e314(0x1fb)),{setupAntidelete}=require('../Antidelete'),antilinkCommand=require(_0x34e314(0x1ce)),chatbotModule=require(_0x34e314(0x1b9)),listonlineCommand=require('../Commands/Admin/listonline'),{kordMsg}=require(_0x34e314(0x222)),{initializeKordEvents}=require(_0x34e314(0x1cd)),{loadCommands}=require('../Plugin/kordLoadCmd'),{againstEventManager}=require('../Plugin/kordEventHandle'),SESSION_DIR=path[_0x34e314(0x1f4)](__dirname,'..',_0x34e314(0x212)),STORE_FILE_PATH=path[_0x34e314(0x1f4)](__dirname,'..',_0x34e314(0x1bc)),LOGGER=pino({'level':process[_0x34e314(0x201)][_0x34e314(0x1fa)]||_0x34e314(0x208)}),MSG_RETRY_CACHE=new NodeCache();let messagesSent=0x0,heartbeatInterval;async function sendHeartbeat(){const _0x3e493c=_0x34e314;try{const _0x1b6ae0=global[_0x3e493c(0x1d0)]['OWNER_NAME'],_0xdaf204=await axios['post'](_0x3e493c(0x1b6),{'botId':_0x1b6ae0,'metadata':{'version':_0x3e493c(0x1ba),'messagesSent':messagesSent,'uptime':Math[_0x3e493c(0x1bb)](process['uptime']()),'lastActive':new Date()[_0x3e493c(0x1c7)]()}},{'headers':{'x-api-key':_0x3e493c(0x21f),'Content-Type':_0x3e493c(0x1f5)},'timeout':0x1388});_0xdaf204[_0x3e493c(0x211)][_0x3e493c(0x1bd)]===_0x3e493c(0x1de)&&(console[_0x3e493c(0x1c6)](chalk['green']('Heartbeat\x20recorded\x20successfully')),console['log'](chalk['blue'](_0x3e493c(0x20c),_0xdaf204[_0x3e493c(0x211)][_0x3e493c(0x211)][_0x3e493c(0x1f8)])));}catch(_0x418791){if(_0x418791['response']){const _0x3c96f7=_0x418791['response']['status'],_0x16084e=_0x418791[_0x3e493c(0x1f2)][_0x3e493c(0x211)]?.[_0x3e493c(0x1c9)]||_0x3e493c(0x1df);switch(_0x3c96f7){case 0x190:console['error'](chalk['red']('Invalid\x20heartbeat\x20data:',_0x16084e));break;case 0x191:console[_0x3e493c(0x209)](chalk[_0x3e493c(0x1dc)](_0x3e493c(0x207)));break;case 0x1f4:console[_0x3e493c(0x209)](chalk[_0x3e493c(0x1dc)](_0x3e493c(0x1c0),_0x16084e));break;default:console[_0x3e493c(0x209)](chalk[_0x3e493c(0x1dc)](_0x3e493c(0x1d7)+_0x3c96f7+'):',_0x16084e));}}else _0x418791['request']?console[_0x3e493c(0x209)](chalk[_0x3e493c(0x1dc)](_0x3e493c(0x1eb))):console['error'](chalk[_0x3e493c(0x1dc)]('Error\x20sending\x20heartbeat:',_0x418791[_0x3e493c(0x1c9)]));}}let heartbeatFailures=0x0;const MAX_FAILURES=0x3,RETRY_DELAY=0x1388;function _0xebc2(){const _0x3b0dcd=['Session\x20ID\x20from\x20config:','close','offline','node-cache','remoteJid','fromJSON','New\x20message\x20received\x20and\x20stored\x20immediately','Commands','logout','Connected\x20successfully!\x20ðŸŽ‰','OWNER_NUMBERS','kordAi.key','post','Using\x20WA\x20v','../Plugin/kordMsg','execute','821165kxljhE','Initial\x20heartbeat\x20established','toString','uptime','https://kordai-dash.vercel.app/api/status/heartbeat',')...','readFileSync','../Commands/Bot/bot','1.0.0','floor','store.json','status','54sgBAPP','Failed\x20to\x20establish\x20initial\x20heartbeat','Server\x20error:','startsWith','Retrying\x20initial\x20heartbeat\x20(','messages.update','2272494uaREul','messages.upsert','log','toISOString','@hapi/boom','message','creds.json','/messagestotal','statusCode','../Plugin/kordEvent','../Commands/Bot/antilink','loadMessage','settings','registered','5601092CidZSe','sendPresenceUpdate','writeFileSync','base64','session-','Heartbeat\x20failed\x20(','Error\x20in\x20getAuthState:','Error\x20in\x20kordAi:','output','init','red','\x1b[33m%s\x1b[0m','success','Unknown\x20error','messageStubType','16038232PGfMZW','Pairing\x20Code\x20for\x20','messages',',\x20isLatest:\x20','json','keys','connection.update','\x1b[31m%s\x1b[0m','blue','yellow','No\x20response\x20from\x20heartbeat\x20server','utf-8','get','green','Using\x20SESSION_ID\x20from\x20creds.json:','creds','requestPairingCode','response','path','join','application/json','ALWAYS_ONLINE','parse','lastHeartbeat','Error\x20deleting\x20old\x20files:','LOG_LEVEL','axios','writeToFile','existsSync','208996LddxkN','SIGINT','Multiple\x20heartbeat\x20failures\x20detected,\x20stopping\x20heartbeat\x20service','env','Heartbeat\x20service\x20stopped','trim','Store\x20file\x20is\x20empty\x20or\x20invalid.\x20Initializing\x20new\x20store.','430150qZdhMj','Failed\x20to\x20send\x20offline\x20status\x20update','Authentication\x20failed.\x20Check\x20API\x20key','silent','error','No\x20SESSION_ID\x20in\x20config\x20or\x20creds.json\x20found.\x20Proceeding\x20to\x20pairing\x20code...','Received\x20SIGINT.\x20Saving\x20store\x20and\x20exiting...','Last\x20heartbeat:','loggedOut','6390048BZyYxC','exit','unavailable','data','Session','Store\x20loaded\x20successfully.'];_0xebc2=function(){return _0x3b0dcd;};return _0xebc2();}async function startHeartbeat(){heartbeatInterval&&clearInterval(heartbeatInterval);heartbeatFailures=0x0;const _0x3c42e2=async()=>{const _0x5c74c4=_0x4fce;try{await sendHeartbeat(),console[_0x5c74c4(0x1c6)](chalk['green'](_0x5c74c4(0x225))),heartbeatFailures=0x0;}catch(_0x11c420){heartbeatFailures++;if(heartbeatFailures<MAX_FAILURES){console[_0x5c74c4(0x1c6)](chalk[_0x5c74c4(0x1ea)](_0x5c74c4(0x1c2)+heartbeatFailures+'/'+MAX_FAILURES+_0x5c74c4(0x1b7))),setTimeout(_0x3c42e2,RETRY_DELAY);return;}console['error'](chalk[_0x5c74c4(0x1dc)](_0x5c74c4(0x1bf)));}};await _0x3c42e2(),heartbeatInterval=setInterval(async()=>{const _0x523afb=_0x4fce;try{await sendHeartbeat(),heartbeatFailures=0x0;}catch(_0x12222f){heartbeatFailures++,heartbeatFailures>=MAX_FAILURES&&(console[_0x523afb(0x209)](chalk['red'](_0x523afb(0x200))),await stopHeartbeat());}},0x5*0x3c*0x3e8);}async function stopHeartbeat(){const _0x23cc24=_0x34e314;if(heartbeatInterval){clearInterval(heartbeatInterval),heartbeatInterval=null,console[_0x23cc24(0x1c6)](chalk[_0x23cc24(0x1ea)](_0x23cc24(0x202)));try{const _0x18857c=global[_0x23cc24(0x1d0)]['OWNER_NAME'];await axios[_0x23cc24(0x220)](_0x23cc24(0x1b6),{'botIdd':_0x18857c,'metadata':{'version':_0x23cc24(0x1ba),'messagesSent':messagesSent,'uptime':Math[_0x23cc24(0x1bb)](process[_0x23cc24(0x227)]()),'lastActive':new Date()[_0x23cc24(0x1c7)](),'status':_0x23cc24(0x216)}},{'headers':{'x-api-key':_0x23cc24(0x21f),'Content-Type':_0x23cc24(0x1f5)}});}catch(_0x8ccc2e){console['error'](chalk[_0x23cc24(0x1dc)](_0x23cc24(0x206)));}}}async function getAuthState(){const _0x1b9385=_0x34e314,_0x38e768=path[_0x1b9385(0x1f4)](SESSION_DIR,_0x1b9385(0x1ca));try{let _0x4af7af=global[_0x1b9385(0x1d0)]['SESSION_ID'];if(_0x4af7af&&_0x4af7af!==''){console['log'](_0x1b9385(0x214),_0x4af7af);const _0x2b5ed9=Buffer['from'](_0x4af7af,_0x1b9385(0x1d5))[_0x1b9385(0x226)](_0x1b9385(0x1ec));fss[_0x1b9385(0x1d4)](_0x38e768,_0x2b5ed9);}else{if(fss[_0x1b9385(0x1fd)](_0x38e768)){const _0x1b2ac7=fss[_0x1b9385(0x1b8)](_0x38e768,_0x1b9385(0x1ec)),_0x92e479=JSON[_0x1b9385(0x1f7)](_0x1b2ac7);console[_0x1b9385(0x1c6)](_0x1b9385(0x1ef),_0x92e479),_0x4af7af=_0x92e479;}else console[_0x1b9385(0x1c6)](_0x1b9385(0x20a));}return console[_0x1b9385(0x1c6)](_0x1b9385(0x1dd),'Using\x20multi-file\x20auth\x20state.'),await useMultiFileAuthState(SESSION_DIR);}catch(_0x463f23){console[_0x1b9385(0x209)](_0x1b9385(0x1e8),_0x1b9385(0x1d8),_0x463f23);throw _0x463f23;}}async function deleteOldFiles(){const _0x5d6c8a=_0x34e314;try{const _0x4091fe=await fs['readdir'](SESSION_DIR);for(const _0x2cc0b3 of _0x4091fe){(_0x2cc0b3[_0x5d6c8a(0x1c1)]('pre-key-')||_0x2cc0b3['startsWith'](_0x5d6c8a(0x1d6))&&_0x2cc0b3!=='session.json')&&(await fs['unlink'](path[_0x5d6c8a(0x1f4)](SESSION_DIR,_0x2cc0b3)),console[_0x5d6c8a(0x1c6)](chalk[_0x5d6c8a(0x1ee)]('Deleted\x20old\x20file:\x20'+_0x2cc0b3)));}}catch(_0x289daa){console[_0x5d6c8a(0x209)](chalk['red'](_0x5d6c8a(0x1f9),_0x289daa));}}async function kordAi(_0x2842e2,_0x15561d){const _0x252fbe=_0x34e314;try{await loadCommands(path[_0x252fbe(0x1f4)](__dirname,'..',_0x252fbe(0x21b))),_0x15561d[_0x252fbe(0x1ed)](_0x252fbe(0x1cb),(_0x58f7b5,_0x22e8f7)=>{const _0x18493f=_0x252fbe;_0x22e8f7[_0x18493f(0x1e5)]({'messageTotal':messagesSent});});let _0xc2a316;try{_0xc2a316=makeInMemoryStore({'logger':LOGGER});const _0x550534=await fs['readFile'](STORE_FILE_PATH,'utf-8');_0x550534&&_0x550534[_0x252fbe(0x203)]()!=='{}'?(_0xc2a316[_0x252fbe(0x219)](JSON[_0x252fbe(0x1f7)](_0x550534)),console[_0x252fbe(0x1c6)](chalk[_0x252fbe(0x1ee)](_0x252fbe(0x213)))):console[_0x252fbe(0x1c6)](chalk[_0x252fbe(0x1ea)](_0x252fbe(0x204)));}catch(_0x3ecf02){console[_0x252fbe(0x209)](chalk[_0x252fbe(0x1dc)]('Error\x20loading\x20store:',_0x3ecf02)),console[_0x252fbe(0x1c6)](chalk[_0x252fbe(0x1ea)]('Initializing\x20new\x20store.')),_0xc2a316=makeInMemoryStore({'logger':LOGGER});}const {state:_0xd9509,saveCreds:_0x2eb2cc}=await getAuthState(),{version:_0x4891fd,isLatest:_0x16a36e}=await fetchLatestBaileysVersion();console[_0x252fbe(0x1c6)](chalk['cyan'](_0x252fbe(0x221)+_0x4891fd[_0x252fbe(0x1f4)]('.')+_0x252fbe(0x1e4)+_0x16a36e));const _0x133895=makeWASocket({'version':_0x4891fd,'auth':{'creds':_0xd9509[_0x252fbe(0x1f0)],'keys':makeCacheableSignalKeyStore(_0xd9509[_0x252fbe(0x1e6)],LOGGER)},'printQRInTerminal':![],'logger':LOGGER,'msgRetryCounterCache':MSG_RETRY_CACHE,'generateHighQualityLinkPreview':!![],'defaultQueryTimeoutMs':undefined,'getMessage':async _0x11c639=>{const _0x34b5e7=_0x252fbe;if(_0xc2a316){const _0x57c9f9=await _0xc2a316[_0x34b5e7(0x1cf)](_0x11c639[_0x34b5e7(0x218)],_0x11c639['id']);return _0x57c9f9?.[_0x34b5e7(0x1c9)]||undefined;}return{'conversation':''};}});_0xc2a316['bind'](_0x133895['ev']),await againstEventManager['init'](_0x133895),initializeKordEvents(_0x133895),_0x133895['ev']['on']('creds.update',_0x2eb2cc);const _0x4ca3ca=setInterval(()=>{const _0xef56eb=_0x252fbe;_0xc2a316[_0xef56eb(0x1fc)](STORE_FILE_PATH);},0x7530);_0x133895['ev']['on'](_0x252fbe(0x1c5),async _0x5c5340=>{const _0x2975f4=_0x252fbe,_0x104675=_0x5c5340[_0x2975f4(0x1e3)][0x0];_0x104675&&(_0xc2a316&&_0xc2a316[_0x2975f4(0x1cf)](_0x104675['key'][_0x2975f4(0x218)],_0x104675['key']['id'],_0x104675),messagesSent++,console[_0x2975f4(0x1c6)](chalk['green'](_0x2975f4(0x21a))),await kordMsg(_0x133895,_0x104675));}),_0x133895['ev']['on'](_0x252fbe(0x1c3),async _0x3c897b=>{const _0x300cb4=_0x252fbe;console['log'](chalk[_0x300cb4(0x1ea)]('Message\x20update\x20event\x20detected'));try{const _0x2c9bcd=await setupAntidelete(_0x133895,_0xc2a316);for(const _0x138915 of _0x3c897b){(_0x138915['update'][_0x300cb4(0x1c9)]===null||_0x138915['update'][_0x300cb4(0x1e0)]===0x2)&&await _0x2c9bcd[_0x300cb4(0x223)](_0x133895,_0x138915,{'store':_0xc2a316});}}catch(_0x1c6a0d){console[_0x300cb4(0x209)](chalk[_0x300cb4(0x1dc)]('Error\x20in\x20antidelete\x20execution:',_0x1c6a0d));}}),_0x133895['ev']['on'](_0x252fbe(0x1e7),async _0xce761d=>{const _0x522ec9=_0x252fbe,{connection:_0xf2df23,lastDisconnect:_0x39f024}=_0xce761d;if(_0xf2df23==='open'){console[_0x522ec9(0x1c6)](chalk['green'](_0x522ec9(0x21d)));global['settings'][_0x522ec9(0x1f6)]?await _0x133895[_0x522ec9(0x1d3)]('available'):await _0x133895[_0x522ec9(0x1d3)](_0x522ec9(0x210));chatbotModule[_0x522ec9(0x1db)](_0x133895),antilinkCommand[_0x522ec9(0x1db)](_0x133895),await startHeartbeat();if(!_0x133895['authState'][_0x522ec9(0x1f0)][_0x522ec9(0x1d1)]){const _0x5b0c4f=global[_0x522ec9(0x1d0)][_0x522ec9(0x21e)]['split'](',')[0x0][_0x522ec9(0x203)](),_0x582046=await _0x133895[_0x522ec9(0x1f1)](_0x5b0c4f);console[_0x522ec9(0x1c6)](chalk[_0x522ec9(0x1e9)](_0x522ec9(0x1e2)+_0x5b0c4f+':\x20'+_0x582046));}}if(_0xf2df23===_0x522ec9(0x215)){await stopHeartbeat();const _0x4b58aa=new Boom(_0x39f024?.[_0x522ec9(0x209)])?.[_0x522ec9(0x1da)]?.[_0x522ec9(0x1cc)]!==DisconnectReason[_0x522ec9(0x20d)];console[_0x522ec9(0x1c6)](chalk[_0x522ec9(0x1ea)]('Connection\x20closed\x20due\x20to:',_0x39f024?.[_0x522ec9(0x209)],'Reconnecting:',_0x4b58aa)),_0x4b58aa?setTimeout(()=>kordAi(_0x2842e2,_0x15561d),0x1388):clearInterval(_0x4ca3ca);}}),process['on'](_0x252fbe(0x1ff),async()=>{const _0x2d4709=_0x252fbe;console[_0x2d4709(0x1c6)](chalk[_0x2d4709(0x1ea)](_0x2d4709(0x20b))),clearInterval(_0x4ca3ca),await stopHeartbeat(),await _0xc2a316[_0x2d4709(0x1fc)](STORE_FILE_PATH),await _0x133895[_0x2d4709(0x21c)](),process[_0x2d4709(0x20f)](0x0);});}catch(_0x5f3ca7){console[_0x252fbe(0x209)](chalk[_0x252fbe(0x1dc)](_0x252fbe(0x1d9),_0x5f3ca7));}}module['exports']={'kordAi':kordAi};